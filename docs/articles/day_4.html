<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to Bioconductor Classes • RPG520</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Bioconductor Classes">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RPG520</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/day_1.html">Day 1: Introduction to the CCR, and to R</a></li>
    <li><a class="dropdown-item" href="../articles/day_2.html">Day 2: Data Management, Visualization, and Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/day_3.html">Day 3: Single Cell Data; Survival Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/day_4.html">Introduction to Bioconductor Classes</a></li>
    <li><a class="dropdown-item" href="../articles/z_appendix.html">Appendix</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lshep/RPG520/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="day_4_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to Bioconductor Classes</h1>
                        <h4 data-toc-skip class="author">Lori Shepherd Kern <a href="mailto:Lori.Shepherd@roswellpark.org" class="email">Lori.Shepherd@roswellpark.org</a>
</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lshep/RPG520/blob/HEAD/vignettes/day_4.Rmd" class="external-link"><code>vignettes/day_4.Rmd</code></a></small>
      <div class="d-none name"><code>day_4.Rmd</code></div>
    </div>

    
    
<style scoped>
ul > li:before {
    color: #1a81c2;
    vertical-align: middle;
    font-family: "Arial Black";
    font-weight: 900;
    margin-left: -.85em;
    }
    </style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><a href="https://contributions.bioconductor.org/important-bioconductor-package-development-features.html#reusebioc" class="external-link uri">https://contributions.bioconductor.org/important-bioconductor-package-development-features.html#reusebioc</a></p>
<p><font color="#87b13f"> Common Bioconductor Classes </font></p>
<p><font size="4"></font></p>
<table style="width:" class="table"><tbody style="font-size: 14px">
<tr>
<th style="width:60%">Data Type</th>
    <th style="width:20%">Package Name</th>
    <th style="width:20%">Function</th>
</tr>
<tr>
<td>Rectangular feature x sample data (RNAseq count matrix, microarray, …)</td>
    <td>SummarizedExperiment</td>
    <td>SummarizedExperiment()</td>
</tr>
<tr>
<td>Genomic coordinates (1-based, closed interval)</td>
    <td>GenomicRanges</td>
    <td>GRanges() or GRangesList()</td>
</tr>
<tr>
<td>Ragged genomic coordinates</td>
    <td>RaggedExperiment</td>
    <td>RaggedExperiment()</td>
</tr>
<tr>
<td>DNA / RNA / AA sequences</td>
    <td>Biostrings</td>
    <td>*StringSet()</td>
</tr>
<tr>
<td>Gene sets</td>
    <td>BiocSet<br>GSEABase</td>
    <td>BiocSet()<br>GeneSet() or GeneSetCollection()</td>
</tr>
<tr>
<td>Multi-omics data</td>
    <td>MultiAssayExperiment</td>
    <td>MultiAssayExperiment()</td>
</tr>
<tr>
<td>Single cell data</td>
    <td>SingleCellExperiment</td>
    <td>SingleCellExperiment()</td>
</tr>
<tr>
<td>Mass spec data</td>
    <td>Spectra</td>
    <td>Spectra()</td>
</tr>
<tr>
<td>File formats</td>
    <td>BiocIO</td>
    <td>BiocFile-class</td>
</tr>
</tbody></table>
<p></p>
</div>
<div class="section level2">
<h2 id="three-commonly-used-or-extended-classes">Three Commonly Used or Extended Classes<a class="anchor" aria-label="anchor" href="#three-commonly-used-or-extended-classes"></a>
</h2>
<ul>
<li><p>Biostrings::*StringSets</p></li>
<li><p>GenomicRanges::GenomicRanges</p></li>
<li><p>SummarizedExperiment::SummarizedExperiment</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="genomic-sequences">Genomic Sequences<a class="anchor" aria-label="anchor" href="#genomic-sequences"></a>
</h2>
<p><a href="https://bioconductor.org/packages/Biostrings" class="external-link">Biostrings</a></p>
<ul>
<li>
<em>Valid</em> data, e.g., alphabet</li>
<li>‘Vector’ interface: <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code>, <code>[</code>, …</li>
<li>Specialized operations, e.g,. <code><a href="https://rdrr.io/pkg/Biostrings/man/reverseComplement.html" class="external-link">reverseComplement()</a></code>
</li>
</ul>
<p>Classes</p>
<ul>
<li>BString / BStringSet</li>
<li>DNAString / DNAStringSet</li>
<li>RNAString / RNAStringSet</li>
<li>AAString / AAStringSet</li>
</ul>
</div>
<div class="section level2">
<h2 id="dna-sequence-example">DNA Sequence Example<a class="anchor" aria-label="anchor" href="#dna-sequence-example"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/Biostrings" class="external-link">Biostrings</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-class.html" class="external-link">DNAStringSet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AAACTG"</span>, <span class="st">"CCCTTCAAC"</span>, <span class="st">"TACGAA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dna</span></span></code></pre></div>
<pre><code><span><span class="co">## DNAStringSet object of length 3:</span></span>
<span><span class="co">##     width seq</span></span>
<span><span class="co">## [1]     6 <span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span></span></span>
<span><span class="co">## [2]     9 <span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFAF;">C</span></span></span>
<span><span class="co">## [3]     6 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span></span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dna</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dna</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## DNAStringSet object of length 3:</span></span>
<span><span class="co">##     width seq</span></span>
<span><span class="co">## [1]     6 <span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span></span></span>
<span><span class="co">## [2]     6 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span></span></span>
<span><span class="co">## [3]     6 <span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="dna-sequence-example-cont-">DNA Sequence Example cont.<a class="anchor" aria-label="anchor" href="#dna-sequence-example-cont-"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">dna</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6 9 6</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">dna</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "AAACTG"    "CCCTTCAAC"</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/reverseComplement.html" class="external-link">reverseComplement</a></span><span class="op">(</span><span class="va">dna</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DNAStringSet object of length 3:</span></span>
<span><span class="co">##     width seq</span></span>
<span><span class="co">## [1]     6 <span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span></span></span>
<span><span class="co">## [2]     9 <span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span></span></span>
<span><span class="co">## [3]     6 <span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span></span></span></code></pre>
<p><img src="images%2Fday4%2Fbiostrings.png" width="20%" height="20%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="importing-genomic-sequence">Importing Genomic Sequence<a class="anchor" aria-label="anchor" href="#importing-genomic-sequence"></a>
</h2>
<p>Import Methods from FASTA/FASTQ</p>
<ul>
<li>readBStringSet / readDNAStringSet / readRNAStringSet / readAAStringSet</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filepath1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"someORF.fa"</span>, package<span class="op">=</span><span class="st">"Biostrings"</span><span class="op">)</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-io.html" class="external-link">readDNAStringSet</a></span><span class="op">(</span><span class="va">filepath1</span><span class="op">)</span></span>
<span><span class="va">x1</span></span></code></pre></div>
<pre><code><span><span class="co">## DNAStringSet object of length 7:</span></span>
<span><span class="co">##     width seq                                               names               </span></span>
<span><span class="co">## [1]  5573 <span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TTTT</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span>...<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span> YAL001C TFC3 SGDI...</span></span>
<span><span class="co">## [2]  5825 <span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span>...<span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #FFD7AF;">TTTTTTT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TT</span> YAL002W VPS8 SGDI...</span></span>
<span><span class="co">## [3]  2987 <span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span>...<span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span> YAL003W EFB1 SGDI...</span></span>
<span><span class="co">## [4]  3929 <span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GGGGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TT</span>...<span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AAAAA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span> YAL005C SSA1 SGDI...</span></span>
<span><span class="co">## [5]  2648 <span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span>...<span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span> YAL007C ERP2 SGDI...</span></span>
<span><span class="co">## [6]  2597 <span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">TTTT</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TTTT</span> YAL008W FUN14 SGD...</span></span>
<span><span class="co">## [7]  2780 <span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GG</span>...<span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AAAAAAAAA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span> YAL009W SPO7 SGDI...</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="importing-genomic-sequences">Importing Genomic Sequences<a class="anchor" aria-label="anchor" href="#importing-genomic-sequences"></a>
</h2>
<p>Utilizing <a href="https://bioconductor.org/packages/BSgenome" class="external-link">BSgenome</a> Packages</p>
<p>BSgenome packages contain sequence information for a given species/build. There are many such packages - you can get a listing using <code>BiocManager::available("BSgenome")</code></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/BSgenome" class="external-link">BSgenome</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/available.html" class="external-link">available</a></span><span class="op">(</span><span class="st">"BSgenome"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'getOption("repos")' replaces Bioconductor standard repositories, see</span></span>
<span><span class="co">## 'help("repositories", package = "BiocManager")' for details.</span></span>
<span><span class="co">## Replacement repositories:</span></span>
<span><span class="co">##     CRAN: https://cloud.r-project.org</span></span></code></pre>
<pre><code><span><span class="co">## [1] "BSgenome"                               </span></span>
<span><span class="co">## [2] "BSgenome.Alyrata.JGI.v1"                </span></span>
<span><span class="co">## [3] "BSgenome.Amellifera.BeeBase.assembly4"  </span></span>
<span><span class="co">## [4] "BSgenome.Amellifera.NCBI.AmelHAv3.1"    </span></span>
<span><span class="co">## [5] "BSgenome.Amellifera.UCSC.apiMel2"       </span></span>
<span><span class="co">## [6] "BSgenome.Amellifera.UCSC.apiMel2.masked"</span></span></code></pre>
<p>Can’t find what you are looking for? Check out the new <a href="https://bioconductor.org/packages/BSgenomeForge" class="external-link">BSgenomeForge</a> for creating a BSgenome package.</p>
</div>
<div class="section level2">
<h2 id="bsgenome">BSgenome<a class="anchor" aria-label="anchor" href="#bsgenome"></a>
</h2>
<p>We can load and inspect a BSgenome package</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BSgenome.Hsapiens.UCSC.hg19</span><span class="op">)</span></span>
<span><span class="va">BSgenome.Hsapiens.UCSC.hg19</span></span></code></pre></div>
<pre><code><span><span class="co">## | BSgenome object for Human</span></span>
<span><span class="co">## | - organism: Homo sapiens</span></span>
<span><span class="co">## | - provider: UCSC</span></span>
<span><span class="co">## | - genome: hg19</span></span>
<span><span class="co">## | - release date: June 2013</span></span>
<span><span class="co">## | - 298 sequence(s):</span></span>
<span><span class="co">## |     chr1                  chr2                  chr3                 </span></span>
<span><span class="co">## |     chr4                  chr5                  chr6                 </span></span>
<span><span class="co">## |     chr7                  chr8                  chr9                 </span></span>
<span><span class="co">## |     chr10                 chr11                 chr12                </span></span>
<span><span class="co">## |     chr13                 chr14                 chr15                </span></span>
<span><span class="co">## |     ...                   ...                   ...                  </span></span>
<span><span class="co">## |     chr19_gl949749_alt    chr19_gl949750_alt    chr19_gl949751_alt   </span></span>
<span><span class="co">## |     chr19_gl949752_alt    chr19_gl949753_alt    chr20_gl383577_alt   </span></span>
<span><span class="co">## |     chr21_gl383578_alt    chr21_gl383579_alt    chr21_gl383580_alt   </span></span>
<span><span class="co">## |     chr21_gl383581_alt    chr22_gl383582_alt    chr22_gl383583_alt   </span></span>
<span><span class="co">## |     chr22_kb663609_alt                                               </span></span>
<span><span class="co">## | </span></span>
<span><span class="co">## | Tips: call 'seqnames()' on the object to get all the sequence names, call</span></span>
<span><span class="co">## | 'seqinfo()' to get the full sequence info, use the '$' or '[[' operator to</span></span>
<span><span class="co">## | access a given sequence, see '?BSgenome' for more information.</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="subsetting-a-bsgenome">Subsetting a BSgenome<a class="anchor" aria-label="anchor" href="#subsetting-a-bsgenome"></a>
</h2>
<p>The main accessor is <code>getSeq</code>, and you can get data by sequence (e.g., entire chromosome or unplaced scaffold), or by passing in a <em>GRanges</em> object, to get just a region.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/getSeq.html" class="external-link">getSeq</a></span><span class="op">(</span><span class="va">BSgenome.Hsapiens.UCSC.hg19</span>, <span class="st">"chr1"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 249250621-letter DNAString object</span></span>
<span><span class="co">## seq: <span style="color: #EEEEEE; background-color: #B2B2B2;">NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN</span>...<span style="color: #EEEEEE; background-color: #B2B2B2;">NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN</span></span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/getSeq.html" class="external-link">getSeq</a></span><span class="op">(</span><span class="va">BSgenome.Hsapiens.UCSC.hg19</span>, <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr6:35310335-35395968"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DNAStringSet object of length 1:</span></span>
<span><span class="co">##     width seq</span></span>
<span><span class="co">## [1] 85634 <span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFD7AF;">T</span>...<span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">AA</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="genomic-ranges">Genomic Ranges<a class="anchor" aria-label="anchor" href="#genomic-ranges"></a>
</h2>
<p><a href="https://bioconductor.org/packages/GenomicRanges" class="external-link">GenomicRanges</a></p>
<p><img src="images%2Fday4%2FGRanges.png" width="90%"></p>
<p>GenomicRanges objects allow for easy selection and subsection of data based on genomic position information.</p>
</div>
<div class="section level2">
<h2 id="where-are-genomicranges-used">Where are GenomicRanges used?<a class="anchor" aria-label="anchor" href="#where-are-genomicranges-used"></a>
</h2>
<p>Everywhere… <br></p>
<ul>
<li>Data (e.g., aligned reads, called peaks, copy number)</li>
<li>Annotations (e.g., genes, exons, transcripts, <a href="https://bioconductor.org/packages/release/BiocViews.html#___TxDb" class="external-link">TxDb</a>)</li>
<li>Close relation to BED files (see <code><a href="https://rdrr.io/pkg/rtracklayer/man/BEDFile-class.html" class="external-link">rtracklayer::import.bed()</a></code> and <a href="https://bioconductor.org/packages/HelloRanges" class="external-link">HelloRanges</a>)</li>
<li>Anywhere there is Genomic positioning information</li>
</ul>
<p><br><br></p>
<p>Utility</p>
<ul>
<li>Also vector interface – <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code>, <code>[</code>, etc.</li>
<li>Tidyverse: <a href="https://bioconductor.org/packages/plyranges" class="external-link">plyranges</a>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="genomicranges">GenomicRanges<a class="anchor" aria-label="anchor" href="#genomicranges"></a>
</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/GenomicRanges" class="external-link">GenomicRanges</a></span><span class="op">)</span></span>
<span><span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1:100-120"</span>, <span class="st">"chr1:115-130"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gr</span></span></code></pre></div>
<pre><code><span><span class="co">## GRanges object with 2 ranges and 0 metadata columns:</span></span>
<span><span class="co">##       seqnames    ranges strand</span></span>
<span><span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span></span>
<span><span class="co">##   [1]     chr1   100-120      *</span></span>
<span><span class="co">##   [2]     chr1   115-130      *</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1:100-120"</span>, <span class="st">"chr1:115-130"</span>, <span class="st">"chr2:200-220"</span><span class="op">)</span>,</span>
<span>strand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+"</span>,<span class="st">"+"</span>,<span class="st">"-"</span><span class="op">)</span>, GC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, length<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"id"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gr</span></span></code></pre></div>
<pre><code><span><span class="co">## GRanges object with 3 ranges and 2 metadata columns:</span></span>
<span><span class="co">##       seqnames    ranges strand |        GC          id</span></span>
<span><span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;character&gt;</span></span>
<span><span class="co">##   [1]     chr1   100-120      + |       1.0         id1</span></span>
<span><span class="co">##   [2]     chr1   115-130      + |       0.5         id2</span></span>
<span><span class="co">##   [3]     chr2   200-220      - |       0.0         id3</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   seqinfo: 2 sequences from an unspecified genome; no seqlengths</span></span></code></pre>
<p>There are lots of utility functions for <em>GRange</em> objects</p>
<p><font size="3"> Help! </font></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"GRanges"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"GRangesList"</span><span class="op">)</span></span>
<span><span class="op">?</span><span class="st">"GRanges"</span></span>
<span><span class="op">?</span><span class="st">"GRangesList"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="granges-functions">GRanges functions<a class="anchor" aria-label="anchor" href="#granges-functions"></a>
</h2>
<p>Intra-range operations</p>
<ul>
<li>e.g., <code><a href="https://rdrr.io/pkg/IRanges/man/intra-range-methods.html" class="external-link">shift()</a></code>, <code><a href="https://rdrr.io/pkg/IRanges/man/intra-range-methods.html" class="external-link">narrow()</a></code>, <code><a href="https://rdrr.io/pkg/IRanges/man/intra-range-methods.html" class="external-link">flank()</a></code>
</li>
</ul>
<p>Inter-range operations</p>
<ul>
<li>e.g., <code><a href="https://rdrr.io/pkg/IRanges/man/inter-range-methods.html" class="external-link">reduce()</a></code>, <code><a href="https://rdrr.io/pkg/IRanges/man/coverage-methods.html" class="external-link">coverage()</a></code>, <code><a href="https://rdrr.io/pkg/IRanges/man/inter-range-methods.html" class="external-link">gaps()</a></code>, <code><a href="https://rdrr.io/pkg/IRanges/man/inter-range-methods.html" class="external-link">disjoin()</a></code>
</li>
</ul>
<p>Between-range operations</p>
<ul>
<li>e.g., <code><a href="https://rdrr.io/pkg/IRanges/man/findOverlaps-methods.html" class="external-link">countOverlaps()</a></code>, <code><a href="https://rdrr.io/pkg/IRanges/man/findOverlaps-methods.html" class="external-link">findOverlaps()</a></code>, <code><a href="https://rdrr.io/pkg/GenomicAlignments/man/summarizeOverlaps-methods.html" class="external-link">summarizeOverlaps()</a></code>
</li>
</ul>
<p><img src="images%2Fday4%2FGenomicRangesSticker.png" width="20%" height="20%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="granges-example">GRanges Example<a class="anchor" aria-label="anchor" href="#granges-example"></a>
</h2>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/intra-range-methods.html" class="external-link">shift</a></span><span class="op">(</span><span class="va">gr</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## GRanges object with 3 ranges and 2 metadata columns:</span></span>
<span><span class="co">##       seqnames    ranges strand |        GC          id</span></span>
<span><span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;character&gt;</span></span>
<span><span class="co">##   [1]     chr1   101-121      + |       1.0         id1</span></span>
<span><span class="co">##   [2]     chr1   116-131      + |       0.5         id2</span></span>
<span><span class="co">##   [3]     chr2   201-221      - |       0.0         id3</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   seqinfo: 2 sequences from an unspecified genome; no seqlengths</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/inter-range-methods.html" class="external-link">reduce</a></span><span class="op">(</span><span class="va">gr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## GRanges object with 2 ranges and 0 metadata columns:</span></span>
<span><span class="co">##       seqnames    ranges strand</span></span>
<span><span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span></span>
<span><span class="co">##   [1]     chr1   100-130      +</span></span>
<span><span class="co">##   [2]     chr2   200-220      -</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   seqinfo: 2 sequences from an unspecified genome; no seqlengths</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1:110-150"</span>, <span class="st">"chr2:150-210"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/findOverlaps-methods.html" class="external-link">countOverlaps</a></span><span class="op">(</span><span class="va">anno</span>, <span class="va">gr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2 1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="lists-of-genomic-ranges">Lists of Genomic Ranges<a class="anchor" aria-label="anchor" href="#lists-of-genomic-ranges"></a>
</h2>
<p><img src="images%2Fday4%2FGRangesList.png" width="90%"> - e.g., exons-within-transcripts, alignments-within-reads</p>
</div>
<div class="section level2">
<h2 id="more-examples">More examples<a class="anchor" aria-label="anchor" href="#more-examples"></a>
</h2>
<p>Returning to BSGenome: Get the sequences for three UTR regions? <font size="3"><code><a href="https://rdrr.io/pkg/GenomicFeatures/man/transcriptsBy.html" class="external-link">threeUTRsByTranscript()</a></code> returns a GRangesList</font></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span><span class="op">)</span></span>
<span><span class="va">txdb</span> <span class="op">&lt;-</span> <span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span></span>
<span></span>
<span><span class="va">threeUTR</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/pkg/GenomicFeatures/man/transcriptsBy.html" class="external-link">threeUTRsByTranscript</a></span><span class="op">(</span><span class="va">txdb</span>, use.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">threeUTR_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicFeatures/man/extractTranscriptSeqs.html" class="external-link">extractTranscriptSeqs</a></span><span class="op">(</span><span class="va">Hsapiens</span>, <span class="va">threeUTR</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>showHeadLines <span class="op">=</span> <span class="fl">3</span>, showTailLines <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">threeUTR_seq</span></span></code></pre></div>
<pre><code><span><span class="co">## DNAStringSet object of length 60740:</span></span>
<span><span class="co">##         width seq                                           names               </span></span>
<span><span class="co">##     [1]   770 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AAAA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span>...<span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span> uc010nxq.1</span></span>
<span><span class="co">##     [2]  1333 <span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">CC</span>...<span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCCC</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span> uc009vjk.2</span></span>
<span><span class="co">##     [3]  2976 <span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">CC</span>...<span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AAAAA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span> uc001aau.3</span></span>
<span><span class="co">##     ...   ... ...</span></span>
<span><span class="co">## [60739]  1191 <span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>...<span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AA</span> uc011mgh.2</span></span>
<span><span class="co">## [60740]  1191 <span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>...<span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AA</span> uc011mgi.2</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="more-examples-1">More examples<a class="anchor" aria-label="anchor" href="#more-examples-1"></a>
</h2>
<p>How many genes are between 2858473 and 3271812 on chr2 in the hg19 genome?</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicFeatures/man/transcripts.html" class="external-link">genes</a></span><span class="op">(</span><span class="va">txdb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   403 genes were dropped because they have exons located on both strands of the</span></span>
<span><span class="co">##   same reference sequence or on more than one reference sequence, so cannot be</span></span>
<span><span class="co">##   represented by a single genomic range.</span></span>
<span><span class="co">##   Use 'single.strand.genes.only=FALSE' to get all the genes in a GRangesList</span></span>
<span><span class="co">##   object, or use suppressMessages() to suppress this message.</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gns</span><span class="op">[</span><span class="va">gns</span> <span class="op"><a href="https://rdrr.io/pkg/IRanges/man/findOverlaps-methods.html" class="external-link">%over%</a></span>  <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr2:2858473-3271812"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## GRanges object with 1 range and 1 metadata column:</span></span>
<span><span class="co">##        seqnames          ranges strand |     gene_id</span></span>
<span><span class="co">##           &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;</span></span>
<span><span class="co">##   7260     chr2 3192741-3381653      - |        7260</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   seqinfo: 93 sequences (1 circular) from hg19 genome</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## OR</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/findOverlaps-methods.html" class="external-link">subsetByOverlaps</a></span><span class="op">(</span><span class="va">gns</span>, <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr2:2858473-3271812"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## GRanges object with 1 range and 1 metadata column:</span></span>
<span><span class="co">##        seqnames          ranges strand |     gene_id</span></span>
<span><span class="co">##           &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;</span></span>
<span><span class="co">##   7260     chr2 3192741-3381653      - |        7260</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   seqinfo: 93 sequences (1 circular) from hg19 genome</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="importing-a-bed-file">Importing a BED file<a class="anchor" aria-label="anchor" href="#importing-a-bed-file"></a>
</h2>
<p>We said earlier, GRanges are closely related to bed files. Lets look at the example in the rtracklayer::import.bed help page:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rtracklayer</span><span class="op">)</span></span>
<span><span class="va">test_bed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"rtracklayer"</span>, <span class="st">"tests"</span>, <span class="st">"test.bed"</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocIO/man/IO.html" class="external-link">import</a></span><span class="op">(</span><span class="va">test_bed</span><span class="op">)</span></span>
<span><span class="va">test</span></span></code></pre></div>
<pre><code><span><span class="co">## UCSC track 'ItemRGBDemo'</span></span>
<span><span class="co">## UCSCData object with 5 ranges and 5 metadata columns:</span></span>
<span><span class="co">##       seqnames              ranges strand |        name     score     itemRgb</span></span>
<span><span class="co">##          &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;numeric&gt; &lt;character&gt;</span></span>
<span><span class="co">##   [1]     chr7 127471197-127472363      + |        Pos1         0     #FF0000</span></span>
<span><span class="co">##   [2]     chr7 127472364-127473530      + |        Pos2         2     #FF0000</span></span>
<span><span class="co">##   [3]     chr7 127473531-127474697      - |        Neg1         0     #FF0000</span></span>
<span><span class="co">##   [4]     chr9 127474698-127475864      + |        Pos3         5     #FF0000</span></span>
<span><span class="co">##   [5]     chr9 127475865-127477031      - |        Neg2         5     #0000FF</span></span>
<span><span class="co">##                     thick                  blocks</span></span>
<span><span class="co">##                 &lt;IRanges&gt;           &lt;IRangesList&gt;</span></span>
<span><span class="co">##   [1] 127471197-127472363 1-300,501-700,1068-1167</span></span>
<span><span class="co">##   [2] 127472364-127473530          1-250,668-1167</span></span>
<span><span class="co">##   [3] 127473531-127474697                  1-1167</span></span>
<span><span class="co">##   [4] 127474698-127475864                  1-1167</span></span>
<span><span class="co">##   [5] 127475865-127477031                  1-1167</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   seqinfo: 2 sequences from an unspecified genome; no seqlengths</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="bed-file-continued">Bed file continued<a class="anchor" aria-label="anchor" href="#bed-file-continued"></a>
</h2>
<p>In fact this class <em>Extends</em> the GenomicRange GRange class</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/methods/is.html" class="external-link">is</a></span><span class="op">(</span><span class="va">test</span>, <span class="st">"GRanges"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>So you can use GRange functions</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/findOverlaps-methods.html" class="external-link">subsetByOverlaps</a></span><span class="op">(</span><span class="va">test</span>, <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr7:127471197-127472368"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## UCSC track 'ItemRGBDemo'</span></span>
<span><span class="co">## UCSCData object with 2 ranges and 5 metadata columns:</span></span>
<span><span class="co">##       seqnames              ranges strand |        name     score     itemRgb</span></span>
<span><span class="co">##          &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;numeric&gt; &lt;character&gt;</span></span>
<span><span class="co">##   [1]     chr7 127471197-127472363      + |        Pos1         0     #FF0000</span></span>
<span><span class="co">##   [2]     chr7 127472364-127473530      + |        Pos2         2     #FF0000</span></span>
<span><span class="co">##                     thick                  blocks</span></span>
<span><span class="co">##                 &lt;IRanges&gt;           &lt;IRangesList&gt;</span></span>
<span><span class="co">##   [1] 127471197-127472363 1-300,501-700,1068-1167</span></span>
<span><span class="co">##   [2] 127472364-127473530          1-250,668-1167</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   seqinfo: 2 sequences from an unspecified genome; no seqlengths</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="side-note">Side Note:<a class="anchor" aria-label="anchor" href="#side-note"></a>
</h2>
<p>Utilizing Bioconductor recommended import/export methods, classes, etc. has other benefits as well…</p>
<p>BED files have 0-based half-open intervals (left end point included, right endpoint ‘after’ the end of the range),</p>
<p>whereas in other parts of the bioinformatic community and in bioc the coordinates are 1-based and closed</p>
<p>Using <code><a href="https://rdrr.io/pkg/BiocIO/man/IO.html" class="external-link">import()</a></code> converts BED coordinates into bioc coordinates.</p>
</div>
<div class="section level2">
<h2 id="working-with-bam-files">Working with BAM files<a class="anchor" aria-label="anchor" href="#working-with-bam-files"></a>
</h2>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/GenomicAlignments" class="external-link">GenomicAlignments</a></span><span class="op">)</span></span>
<span><span class="va">fls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"GenomicAlignments"</span><span class="op">)</span>,</span>
<span>                  recursive<span class="op">=</span><span class="cn">TRUE</span>, pattern<span class="op">=</span><span class="st">"*bam$"</span>, full<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fls</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/path.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">fls</span><span class="op">)</span></span>
<span><span class="va">bf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rsamtools/man/BamFile-class.html" class="external-link">BamFileList</a></span><span class="op">(</span><span class="va">fls</span>, index<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>, yieldSize<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span></span>
<span>    seqnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr2L"</span>, <span class="st">"chr2R"</span>, <span class="st">"chr3L"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    ranges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">3000</span>, <span class="fl">4000</span>, <span class="fl">7000</span>, <span class="fl">2000</span>, <span class="fl">3000</span>, <span class="fl">3600</span>, </span>
<span>                       <span class="fl">4000</span>, <span class="fl">7500</span>, <span class="fl">5000</span>, <span class="fl">5400</span><span class="op">)</span>, </span>
<span>                     width<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fl">600</span>, <span class="fl">900</span>, <span class="fl">500</span>, <span class="fl">300</span>, <span class="fl">900</span>, </span>
<span>                             <span class="fl">300</span>, <span class="fl">500</span>, <span class="fl">500</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicAlignments/man/summarizeOverlaps-methods.html" class="external-link">summarizeOverlaps</a></span><span class="op">(</span><span class="va">genes</span>, <span class="va">bf</span><span class="op">)</span></span>
<span><span class="va">se</span></span></code></pre></div>
<pre><code><span><span class="co">## class: RangedSummarizedExperiment </span></span>
<span><span class="co">## dim: 11 2 </span></span>
<span><span class="co">## metadata(0):</span></span>
<span><span class="co">## assays(1): counts</span></span>
<span><span class="co">## rownames: NULL</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(2): sm_treated1.bam sm_untreated1.bam</span></span>
<span><span class="co">## colData names(0):</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Start differential expression analysis with the DESeq2 or edgeR</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summarized-experiments">Summarized Experiments<a class="anchor" aria-label="anchor" href="#summarized-experiments"></a>
</h2>
<p><font size="3"> SummarizedExperiment objects are popular objects for representing expression data and other rectangular data (feature x sample data). Incoming packages are now strongly recommended to use this class representation instead of ExpressionSet. </font></p>
<p><img src="images%2Fday4%2Fsubset.png" width="70%"></p>
<p><font size="3"> three components: underlying ‘matrix’ ‘row’ annotations (genomic features) ‘column’ annotations (sample descriptions) </font></p>
</div>
<div class="section level2">
<h2 id="summarized-experiments-1">Summarized Experiments<a class="anchor" aria-label="anchor" href="#summarized-experiments-1"></a>
</h2>
<p><img src="images%2Fday4%2FSummarizedExperiment.png" width="70%"></p>
</div>
<div class="section level2">
<h2 id="components-1-">Components 1.<a class="anchor" aria-label="anchor" href="#components-1-"></a>
</h2>
<p>Main matrix of values / count data / expression values / etc …</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">countsFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"RPG520"</span>, <span class="st">"extdata"</span>, <span class="st">"airway_counts.csv"</span><span class="op">)</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">countsFile</span>, row.names<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">counts</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                 SRR1039508 SRR1039509 SRR1039512 SRR1039513 SRR1039516</span></span>
<span><span class="co">## ENSG00000000003        679        448        873        408       1138</span></span>
<span><span class="co">## ENSG00000000419        467        515        621        365        587</span></span>
<span><span class="co">## ENSG00000000457        260        211        263        164        245</span></span>
<span><span class="co">##                 SRR1039517 SRR1039520 SRR1039521</span></span>
<span><span class="co">## ENSG00000000003       1047        770        572</span></span>
<span><span class="co">## ENSG00000000419        799        417        508</span></span>
<span><span class="co">## ENSG00000000457        331        233        229</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="component-2-">Component 2.<a class="anchor" aria-label="anchor" href="#component-2-"></a>
</h2>
<p>Sample data / Phenotypic data / Sample specific information / etc …</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colDataFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"RPG520"</span>, <span class="st">"extdata"</span>, <span class="st">"airway_colData.csv"</span><span class="op">)</span></span>
<span><span class="va">colData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">colDataFile</span>, row.names<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">colData</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##            SampleName    cell   dex albut</span></span>
<span><span class="co">## SRR1039508 GSM1275862  N61311 untrt untrt</span></span>
<span><span class="co">## SRR1039509 GSM1275863  N61311   trt untrt</span></span>
<span><span class="co">## SRR1039512 GSM1275866 N052611 untrt untrt</span></span>
<span><span class="co">## SRR1039513 GSM1275867 N052611   trt untrt</span></span>
<span><span class="co">## SRR1039516 GSM1275870 N080611 untrt untrt</span></span>
<span><span class="co">## SRR1039517 GSM1275871 N080611   trt untrt</span></span>
<span><span class="co">## SRR1039520 GSM1275874 N061011 untrt untrt</span></span>
<span><span class="co">## SRR1039521 GSM1275875 N061011   trt untrt</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="component-3-">Component 3.<a class="anchor" aria-label="anchor" href="#component-3-"></a>
</h2>
<p>Genomic position information / Information about features / etc …</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rangesFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"RPG520"</span>, <span class="st">"extdata"</span>, <span class="st">"airway_rowRanges.rds"</span><span class="op">)</span></span>
<span><span class="va">rowRanges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/updateObject.html" class="external-link">updateObject</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">rangesFile</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>showHeadLines <span class="op">=</span> <span class="fl">3</span>, showTailLines <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">rowRanges</span></span></code></pre></div>
<pre><code><span><span class="co">## GRangesList object of length 33469:</span></span>
<span><span class="co">## $ENSG00000000003</span></span>
<span><span class="co">## GRanges object with 17 ranges and 2 metadata columns:</span></span>
<span><span class="co">##        seqnames            ranges strand |   exon_id       exon_name</span></span>
<span><span class="co">##           &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt;     &lt;character&gt;</span></span>
<span><span class="co">##    [1]        X 99883667-99884983      - |    667145 ENSE00001459322</span></span>
<span><span class="co">##    [2]        X 99885756-99885863      - |    667146 ENSE00000868868</span></span>
<span><span class="co">##    [3]        X 99887482-99887565      - |    667147 ENSE00000401072</span></span>
<span><span class="co">##    ...      ...               ...    ... .       ...             ...</span></span>
<span><span class="co">##   [16]        X 99891790-99892101      - |    667160 ENSE00001863395</span></span>
<span><span class="co">##   [17]        X 99894942-99894988      - |    667161 ENSE00001828996</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   seqinfo: 722 sequences (1 circular) from an unspecified genome</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## &lt;33468 more elements&gt;</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="benefit-of-containers">Benefit of Containers<a class="anchor" aria-label="anchor" href="#benefit-of-containers"></a>
</h2>
<p>Could manipulate independently…</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cidx</span> <span class="op">&lt;-</span> <span class="va">colData</span><span class="op">$</span><span class="va">dex</span> <span class="op">==</span> <span class="st">"trt"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">counts</span><span class="op">[</span>, <span class="va">cidx</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">counts</span><span class="op">[</span>, <span class="op">!</span><span class="va">cidx</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    log<span class="op">=</span><span class="st">"xy"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="day_4_files/figure-html/sebad-1.png" width="50%" height="50%"></p>
<ul>
<li>very fragile, e.g., what if <code>colData</code> rows had been re-ordered?</li>
</ul>
</div>
<div class="section level2">
<h2 id="summarizedexperiment">SummarizedExperiment<a class="anchor" aria-label="anchor" href="#summarizedexperiment"></a>
</h2>
<p>Solution: coordinate in a single object – <a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></span><span class="op">(</span><span class="va">counts</span>, rowRanges <span class="op">=</span> <span class="va">rowRanges</span>, colData <span class="op">=</span> <span class="va">colData</span><span class="op">)</span></span>
<span><span class="va">cidx</span> <span class="op">&lt;-</span> <span class="va">se</span><span class="op">$</span><span class="va">dex</span> <span class="op">==</span> <span class="st">"trt"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/MatrixGenerics/man/rowMeans.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">[</span>, <span class="va">cidx</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/MatrixGenerics/man/rowMeans.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">[</span>, <span class="op">!</span><span class="va">cidx</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    log<span class="op">=</span><span class="st">"xy"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="day_4_files/figure-html/segood-1.png" width="50%" height="50%"></p>
</div>
<div class="section level2">
<h2 id="benefits">Benefits<a class="anchor" aria-label="anchor" href="#benefits"></a>
</h2>
<ul>
<li>Much more robust to ‘bookkeeping’ errors</li>
<li>matrix-like interface: <code><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim()</a></code>, two-dimensional <code>[</code>, …</li>
<li>accessors: <code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay()</a></code>, <code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData()</a></code> / <code>rowRanges()</code>, <code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData()</a></code>, …</li>
</ul>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 33469     8</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">se</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "SRR1039512" "SRR1039513"</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">colData</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "SampleName" "cell"       "dex"        "albut"      "Run"       </span></span>
<span><span class="co">## [6] "avgLength"  "Experiment" "Sample"     "BioSample"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="popular">Popular<a class="anchor" aria-label="anchor" href="#popular"></a>
</h2>
<p>Many package make use of or extend the ideas of SummarizedExperiment</p>
<ul>
<li>SingleCellExpeirment</li>
<li>TimeSeriesExperiment</li>
<li>LoomExperiment</li>
<li>TreeSummarizedExperiment</li>
<li>MultiAssayExperiment</li>
</ul>
<p><img src="images%2Fday4%2FSE.png" width="20%" height="20%"><img src="images%2Fday4%2FMAE.png" width="20%" height="20%"><img src="images%2Fday4%2FSCE.png" width="20%" height="20%"></p>
</div>
<div class="section level2">
<h2 id="help">Help<a class="anchor" aria-label="anchor" href="#help"></a>
</h2>
<p>In R:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"SummarizedExperiment"</span><span class="op">)</span></span>
<span><span class="op">?</span><span class="st">"SummarizedExperiment"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html" class="external-link">browseVignettes</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"SummarizedExperiment"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Support site, <a href="https://support.bioconductor.org" class="external-link uri">https://support.bioconductor.org</a>
</li>
<li>Bioc-devel, <a href="mailto:bioc-devel@r-project.org" class="email">bioc-devel@r-project.org</a>
</li>
</ul>
<p>Website: <a href="https://bioconductor.org" class="external-link uri">https://bioconductor.org</a></p>
<p><img src="images%2Fday4%2FbioC.png" width="25%" height="25%" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Morgan, Lori Kern.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
